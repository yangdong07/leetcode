### 5. Longest Palindromic Substring

**Dynamic Programming**, **String**    [ðŸ§¡](https://leetcode.com/problems/longest-palindromic-substring)    	[ðŸ’¡](https://leetcode.com/articles/longest-palindromic-substring)

#### Description

Given a string **s**, find the longest palindromic substring in **s**. You may assume that the maximum length of **s** is 1000.

**Example 1:**

```
Input: "babad"
Output: "bab"
Note: "aba" is also a valid answer.
```

**Example 2:**

```
Input: "cbbd"
Output: "bb"
```

#### Analysis

å›žæ–‡å­—ç¬¦ä¸²ã€‚

é¢˜æ„å¾ˆç®€å•ï¼š æ‰¾å‡ºä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æœ€é•¿çš„å›žæ–‡å­—ç¬¦ä¸²ã€‚

ä¾‹å¦‚ï¼š `ababa` å°±æ˜¯ä¸€ä¸ªå›žæ–‡å­—ä¸²ã€‚

ç”¨åˆ°åŠ¨æ€è§„åˆ’æ€æƒ³ã€‚ç®€å•å›žé¡¾ä¸€ä¸‹åŠ¨æ€è§„åˆ’æ€æƒ³ï¼ŒåŠ¨æ€è§„åˆ’ä¸€èˆ¬ç”¨åœ¨æ±‚æœ€ä¼˜è§£çš„é—®é¢˜ä¸­ã€‚ åŠ¨æ€è§„åˆ’åŒ…æ‹¬ä»¥ä¸‹4ä¸ªæ­¥éª¤ï¼š

1. æè¿°æœ€ä¼˜è§£çš„ç»“æž„ï¼Œ å¹¶ä¸”å¯ä»¥åˆ†è§£æˆå­é—®é¢˜çš„æœ€ä¼˜è§£çš„é€‰æ‹©ã€‚
2. é€’å½’å®šä¹‰æœ€ä¼˜è§£çš„å€¼ï¼Œå³å­é—®é¢˜ç»„åˆ
3. æŒ‰è‡ªåº•å‘ä¸Šçš„æ–¹å¼è®¡ç®—å‡ºæœ€ä¼˜è§£çš„å€¼
4. ç”±è®¡ç®—å‡ºçš„ç»“æžœæž„é€ ä¸€ä¸ªæœ€ä¼˜è§£

è¯´çš„æ¯”è¾ƒæŠ½è±¡ï¼Œå…³é”®ç‚¹åœ¨äºŽ æœ€ä¼˜è§£çš„ç»“æž„å¯ä»¥åˆ†è§£æˆå­é—®é¢˜çš„æœ€ä¼˜è§£çš„é€‰æ‹©ã€‚


#### Solution1

å›žæ–‡å­—ç¬¦ä¸²æ²¡è¿™ä¹ˆéº»çƒ¦ï¼Œå…¶å®žå¾ˆç›´è§‚ï¼š éåŽ†æ¯ä¸ªå­—ç¬¦ï¼Œä»¥æ¯ä¸ªå­—ç¬¦ä¸ºä¸­å¿ƒå‘ä¸¤è¾¹æ‰©å±•æœç´¢ï¼Œç›´åˆ°ä¸æ»¡è¶³å›žæ–‡ç»“æž„ä¸ºæ­¢ã€‚ è¿™ç§æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n^2)$ï¼Œ ç©ºé—´å¤æ‚åº¦æ˜¯ $O(1)$ï¼Œå…¶å®žå¯ä»¥å°±åœ°æœç´¢ã€‚

ç»å¸¸å°±æ˜¯è¾¹ç•Œæ¡ä»¶çš„trickï¼š

1. å…³äºŽ `expand`ï¼Œ
    1. å¦‚æžœ `i==j`ï¼Œå°±æ˜¯ä»Žå­—ç¬¦å±•å¼€ï¼Œå¾—åˆ°çš„é•¿åº¦æ˜¯å¥‡æ•°ï¼› å¦‚æžœ `j = i + 1`ï¼Œå°±æ˜¯ä»Žä¸¤ä¸ªå­—ç¬¦å±•å¼€ï¼Œå¾—åˆ°çš„é•¿åº¦æ˜¯å¶æ•°ã€‚
    2. å¦‚æžœ `i==j`ï¼Œé‚£ä¹ˆä¸€å®šæœ‰ `s[i] == s[j]`ï¼Œ ç›´æŽ¥è®¡ç®— `j - i` å¾—åˆ°çš„æ˜¯å¶æ•°ï¼Œ éœ€è¦å‡1
    3. å¦‚æžœ `j = i + 1`ï¼Œå¦‚æžœ `s[i] == s[j]`ï¼Œ è®¡ç®— `j - i` å¾—åˆ° 3ï¼Œ éœ€è¦å‡1ã€‚
2. å…³äºŽè®¡ç®—å›žæ–‡å­ä¸²çš„èµ·æ­¢ä½ç½®ï¼š
    1. å¦‚æžœ l  æ˜¯å¥‡æ•°ï¼Œ è¡¨ç¤ºä»Ž1ä¸ªå­—ç¬¦å±•å¼€ï¼Œ `j = i - l // 2 , k = i + l // 2`
    2. å¦‚æžœ l  æ˜¯å¶æ•°ï¼Œ è¡¨ç¤ºä»Ž2ä¸ªå­—ç¬¦å±•å¼€ï¼Œ `j = i - l // 2 - 1, k = i + l // 2`
    3. å¯ä»¥çœ‹åˆ° k çš„è¡¨è¾¾å¼éƒ½ä¸€æ ·ã€‚ j çš„è¡¨è¾¾å¼éœ€è¦è°ƒå’Œä¸€ä¸‹ï¼Œ å¯ä»¥å˜æˆ `j = i - (l - 1) // 2`ï¼Œ ç¬¦åˆå¥‡å¶æƒ…å†µã€‚


```python
class Solution:
    def longestPalindrome(self, s):
        """
        :type s: str
        :rtype: str
        """
        k = j = 0
        for i in range(len(s)):
            l1 = self.expand(s, i, i)
            l2 = self.expand(s, i, i+1)
            l = max(l1, l2)
            if l > k - j:
                j = i - (l - 1) // 2
                k = i + l // 2
        return s[j:k+1]

    def expand(self, s, i, j):
        while (i >=0 and j < len(s) and s[i] == s[j]):
            i -= 1
            j += 1
        return j - i - 1

Solution().longestPalindrome('abaabadddd')
```

#### Solution2: Manacherâ€™s Algorithm

æ ¸å¿ƒæ€æƒ³ï¼š åˆ©ç”¨ å›žæ–‡å­ä¸²çš„ç‰¹ç‚¹ï¼š å¯¹å›žæ–‡çš„å¦ä¸€ä¾§å­ä¸²çœç•¥æ‰©å±•æœç´¢

å…·ä½“çš„è§£é‡Šè§ï¼š <https://articles.leetcode.com/longest-palindromic-substring-part-ii/>

ä¸€äº›ç»†èŠ‚ï¼š

1. åœ¨å¤´å’Œå°¾åŠ ä¸Š '^$' ä¸»è¦æ˜¯ä¸ºäº†é¿å…nsçš„indexé”™è¯¯ã€‚
2. æ’å…¥ '#â€˜ å¯ä»¥å·§å¦™ä¼˜é›…çš„ç®€åŒ–é—®é¢˜ã€‚è¯¦è§ä¸Šé¢çš„é“¾æŽ¥ã€‚
3. rè¡¨ç¤ºå·²çŸ¥çš„å›žæ–‡å­ä¸²çš„æœ€å¤§å³è¾¹ç•Œï¼ˆåœ¨è¿™ä¸ªèŒƒå›´å†…å¯ä»¥é‡‡å–ä¸€äº›é•œåƒç­–ç•¥ï¼‰ï¼Œ cè¡¨ç¤ºè¿™ä¸ªå›žæ–‡å­ä¸²çš„ä¸­å¿ƒä½ç½®ã€‚
4. `p = min(r - i, P[i_mirror]) if r > i else 0` æ˜¯å…³é”®çš„trickã€‚
    1. æ‹†å¼€è§£é‡Šï¼š å¦‚æžœ `r <= i`ï¼Œè¡¨ç¤º i è¶…å‡ºäº†æœ€å¤§å³è¾¹ç•Œï¼Œè¿™æ—¶å€™å°±è€è€å®žå®žä»Žè¿™é‡Œæ‰©å±•ï¼Œæ‰¾ `p`
    2. å¦‚æžœ `r > i`ï¼Œæ¯”è¾ƒ `r - i` å³iåˆ°å³è¾¹ç•Œçš„å‰©ä½™éƒ¨åˆ†ï¼Œå’Œé•œåƒä¸­å¿ƒå›žæ–‡å­ä¸²é•¿åº¦ `P[i_mirror]`
        1. å¦‚æžœ å‰©ä½™éƒ¨åˆ†å¤šï¼Œå®Œå…¨å¯ä»¥é•œåƒè¿‡æ¥ã€‚æ‰€ä»¥ `p = P[i_mirror]`
        2. å¦‚æžœ å‰©ä½™éƒ¨åˆ†å°‘ï¼Œå³è¾¹ç•Œä»¥å†…çš„è‚¯å®šæ˜¯å›žæ–‡çš„ï¼Œä½†æ˜¯å³è¾¹ç•Œä»¥å¤–çš„å°±éœ€è¦æ‰©å±•æœç´¢ã€‚ï¼ˆä½†æ˜¯é€»è¾‘ä¸Šï¼Œæ²¡å¿…è¦ç»§ç»­æ‰©å±•æœç´¢ã€‚å› ä¸ºå¦‚æžœå³è¾¹ç•Œä»¥å¤–ä¹Ÿç¬¦åˆå›žæ–‡æ¡ä»¶ï¼Œé‚£ä¹ˆé•œåƒèŒƒå›´æ˜¯å¢žå¤§çš„ï¼Œä¹‹å‰çš„æœ€å¤§å³è¾¹ç•Œæ¡ä»¶ä¸æˆç«‹ï¼‰
        3. æ‰€ä»¥ç”¨ `min(r - i, P[i_mirror])`
5. å¦‚æžœä»Ž i å¼€å§‹çš„æ‰©å±•æœç´¢çš„èŒƒå›´è¶…è¿‡äº†å³è¾¹ç•Œï¼Œé‚£ä¹ˆå°±å®šä¹‰æ–°çš„ä¸­å¿ƒå’Œè¾¹ç•Œä½ç½®ã€‚
5. æœ€åŽç”¨åˆ° `argmax` æ‰¾åˆ°æœ€é•¿å›žæ–‡å­ä¸²çš„ä¸­å¿ƒä½ç½®ã€‚
6. ç”¨æ›¿æ¢æ¯”ç”¨è®¡ç®—åŽŸå­—ç¬¦ä¸²çš„ä½ç½®ï¼Œä¸ä»…çœäº‹ï¼Œè¿˜çœæ—¶é—´ã€‚ã€‚ã€‚ã€‚ä¸çº ç»“

åŽŸå§‹ç®—æ³•çš„å¤æ‚åº¦æ˜¯ $O(n^2)$ï¼Œ è¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦å¯ä»¥è¾¾åˆ° $O(n)$ï¼Œä¸ºä»€ä¹ˆï¼Œå¯ä»¥æ„Ÿè§‰åˆ°ï¼š åˆ°è¾¾å³è¾¹ç•Œçš„æœç´¢è¿‡ç¨‹æ˜¯çº¿æ€§çš„ã€‚åœ¨åˆ°è¾¾å³è¾¹ç•ŒåŽï¼Œåœ¨å³è¾¹ç•Œä¹‹å†…çš„å°±**ä¸ç”¨é‡å¤æœç´¢ï¼Œåªéœ€è¦çº¿æ€§æ—¶é—´çš„è®¡ç®—è€Œå·²**ã€‚ è™½ç„¶æ˜¯ä¸¤ä¸ªå¾ªçŽ¯åµŒå¥—ï¼Œä½†å¥½æ¯”ä½ è¿½æˆ‘èµ¶ï¼Œæ‰€ä»¥å°±æ˜¯çº¿æ€§çš„ã€‚

```python
class Solution:
    def longestPalindrome(self, s):
        """
        :type s: str
        :rtype: str
        """
        ns = '^#' + '#'.join(s) + '#$'
        P  = [0]
        c = r = 0
        for i in range(1, len(ns)-1):
            i_mirror = 2 * c - i

            p = min(r - i, P[i_mirror]) if r > i else 0
            while (ns[i + p + 1] == ns[i - p - 1]):
                p += 1

            if i + p > r:
                c = i
                r = i + p

            P.append(p)

        center, length = max(enumerate(P), key=lambda x:x[1])
        return ns[center - length: center + length].replace('#', '')

Solution().longestPalindrome('abaabadddd')
```
