### 33. Search in Rotated Sorted Array

**Array**, **Binary Search**    [ğŸ§¡](https://leetcode.com/problems/search-in-rotated-sorted-array)    

#### Description

Suppose an array sorted in ascending order is rotated at some pivot unknown to you beforehand.

(i.e., `[0,1,2,4,5,6,7]` might become `[4,5,6,7,0,1,2]`).

You are given a target value to search. If found in the array return its index, otherwise return `-1`.

You may assume no duplicate exists in the array.

Your algorithm's runtime complexity must be in the order ofÂ _O_(logÂ _n_).

**Example 1:**

```
Input: nums = [4,5,6,7,0,1,2], target = 0
Output: 4
```

**Example 2:**

```
Input: nums = [4,5,6,7,0,1,2], target = 3
Output: -1
```

#### Analysis

æœ‰ä¸€ä¸ªæœ‰åºæ•°ç»„ï¼Œä¸è¿‡æ˜¯ä¸€ä¸ªrotated æœ‰åºæ•°ç»„ã€‚ ä¾‹å¦‚ï¼š `[0,1,2,4,5,6,7]` æ—‹è½¬åå˜æˆ `[4,5,6,7,0,1,2]`

ç”¨äºŒåˆ†æŸ¥æ‰¾æ³•æŸ¥æ‰¾ç›®æ ‡ã€‚

ä¸€ç§æ¯”è¾ƒç›´æ¥çš„æ€è·¯æ˜¯ï¼š å…ˆæ‰¾åˆ° æœ€å°å€¼æ‰€åœ¨ï¼ˆåç§»ï¼‰ï¼Œç„¶åç”¨åç§»çš„äºŒåˆ†æŸ¥æ‰¾ã€‚

```
     /
    /
----    ----
       /
      /
```
æ•°ç»„å¦‚æœç”»å›¾åº”è¯¥æ˜¯è¿™æ ·å­çš„ã€‚

1. æ‰¾æœ€å°å€¼ï¼š å¦‚æœ `nums[mid] > nums[hi]`ï¼Œ åˆ™æœ€å°å€¼åœ¨å³è¾¹ï¼Œå¦åˆ™åœ¨å·¦è¾¹ã€‚
2. äºŒåˆ†æŸ¥æ‰¾ï¼š åç§»é‡ã€‚


```python
class Solution1:
    def search(self, nums, target):
        n = len(nums)
        if n == 0:
            return -1

        # find the min
        lo, hi = 0, n - 1
        while lo < hi:
            mid = (lo + hi) // 2
            if nums[mid] > nums[hi]:
                lo = mid + 1
            else:
                hi = mid

        # offset
        i = lo
        # binary search
        lo, hi = 0, n - 1
        while lo < hi:
            mid = (lo + hi) // 2
            if target > nums[(mid + i) % n]:
                lo = mid + 1
            else:
                hi = mid
        i = (lo + i) % n
        return i if nums[i] == target else -1
```

#### Solution

è¿˜æœ‰ä¸€ç§å·§å¦™çš„åŠæ³•ï¼Œç›´æ¥äºŒåˆ†æŸ¥æ‰¾ï¼Œå‚è€ƒ <https://leetcode.com/problems/search-in-rotated-sorted-array/discuss/14419/Pretty-short-C++JavaRubyPython>


```
     /
    /
----    ----
       /
      /
```

åˆ†å‡ ç§æƒ…å†µï¼š

1.  `nums[0] <= target <= nums[mid]`ï¼Œ è¿™ç§æƒ…å†µï¼Œ `nums[0...mid]` æ˜¯é€’å¢åºåˆ—ï¼Œ targetéƒ½åœ¨å·¦è¾¹ã€‚
2.  `target <= nums[mid] < nums[0]`ï¼Œ è¿™ç§æƒ…å†µï¼Œ`nums[0...mid]` æ˜¯æŠ˜çº¿ï¼Œ `nums [mid] <= nums[mid+1...]` ä¸”é€’å¢ã€‚ target åœ¨å·¦ä¾§ä¸‹æŠ˜çº¿å¤„ã€‚
3.  `nums[mid] < nums[0] <= target`ï¼Œ åŒä¸Šï¼Œä½†æ˜¯ç”±äº `nums[mid+1...] <= nums[0]`ï¼Œ ä¹Ÿåœ¨å·¦è¾¹ä¸ŠæŠ˜çº¿æ‰¾ targetã€‚ ï¼ˆå¦‚æœç­‰å·æˆç«‹ï¼Œåˆ™ `target == nums[0]` ä¹Ÿæ˜¯åœ¨å·¦è¾¹ã€‚ã€‚)

ä»¥ä¸Šæ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œåˆ™åœ¨å³è¾¹æ‰¾ã€‚ `lo = mid + 1`

åœ¨ä»”ç»†çœ‹è¿™äº›æ¡ä»¶ï¼Œå¯ä»¥å‘ç°å…¶å®å°±æ˜¯ï¼š

- `nums[0] <= target`
- `target <= nums[mid]`
- `nums[0] <= nums[mid]`

ä¸‰ä¸ªéƒ½æˆç«‹ï¼Œæˆ–è€…åªæœ‰ä¸€ä¸ªæˆç«‹çš„æ—¶å€™ï¼Œåœ¨å·¦è¾¹æ‰¾ã€‚ å› æ­¤å°±æ˜¯ `(a ^ b ^ c)` äº¦æˆ–å…³ç³»

ç”±äº `!(a ^ b ^ c) = !a ^ !b ^ !c`ï¼Œè¿˜å¯ä»¥è¡¨ç¤ºæˆï¼š

- `nums[0] > target`
- `target > nums[mid]`
- `nums[0] > nums[mid]`

çš„äº¦æˆ–ï¼Œä¸è¿‡æ¡ä»¶ç›¸åï¼Œå¦‚æœä¸‰ä¸ªéƒ½æˆç«‹ï¼Œæˆ–è€…åªæœ‰ä¸€ä¸ªæˆç«‹ï¼Œåœ¨å³è¾¹æ‰¾ã€‚ã€‚ã€‚ã€‚

è¿™ç§æ–¹æ³•ç»•çš„å¼¯å¤ªå¤šäº†ã€‚ã€‚ã€‚ã€‚ã€‚ä¸€èˆ¬äººç»å¯¹æƒ³ä¸åˆ°ã€‚ã€‚


#### Solution3

åšå®Œç¬¬ 81 é¢˜ï¼Œå¯¹è¿™é“é¢˜æœ‰è¿›ä¸€æ­¥çš„ç†è§£ï¼Œå¯ä»¥è¿™ä¹ˆåšï¼š

æ³¨æ„è¿™é‡Œæ•°ç»„ä¸­æ²¡æœ‰é‡å¤æ•°å­—ã€‚å› ä¸º `mid` ä¸å¯èƒ½ç­‰äº `r`ï¼Œ å› æ­¤ `nums[mid] != nums[r]`

```python
def search(self, nums, target):
    if not nums:
        return -1

    l, r = 0, len(nums) - 1
    while l < r:
        mid = l + (r - l) // 2
        if nums[mid] == target:
            return mid

        if nums[mid] < nums[r]:
            if nums[mid] < target <= nums[r]:
                l = mid + 1
            else:
                r = mid - 1
        else:
            if nums[l] <= target < nums[mid]:
                r = mid - 1
            else:
                l = mid + 1
    return l if nums[l] == target else -1
```



#### [Code](../python/33.%20Search%20in%20Rotated%20Sorted%20Array.py)
